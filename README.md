# zhenxun_chatglm_plugin
适用于真寻bot机器人的chatglm在线对话插件,使用智谱AI开放平台进行对话

# 支持的适配器
``OneBot v11``<br>
``OneBot v12``

## 环境要求
Python >=3.10<br>
zhenxun_bot >= v0.2.4-fix3

## 如何安装
**目前仅支持git手动安装，后续会加入pip和nb-cil**<br>
```
git clone https://github.com/laowumdzz/zhenxun_chatglm_plugin.git
pip install -r requirements.txt
```

## 配置
### 必填
```
glm_api_key='你的智谱开放平台API_KEY'
```

### 选填，不填使用默认值
```
glm_cmd="talk"
"""插件命令"""

glm_history_path="./resources/chat_history"
"""聊天记录储存路径"""

prompt="./data/prompt.json"
"""预设文件路径"""

glm_max_tokens=0
"""最大输出的token,0为不限"""

glm_model="glm-4-plus"
"""默认对话使用的模型，目前支持的模型有：('glm-4-plus', 'glm-4-0520', 'glm-4', 'glm-4-air', 'glm-4-airx', 'glm-4-long', 'glm-4-flashx', 'glm-4-flash', 'glm-4v-plus', 'glm-4v', 'glm-4v-flash'), ('charglm-4', 'emohaa')"""

pic_vid_model="glm-4v"
"""默认图片及视频识别模型: glm-4v, glm-4v-plus"""

glm_temperature=0.6
"""采样温度，控制输出的随机性"""

glm_private=True
"""是否启用私聊 仅Onebot V11"""
```

### 关于预设文件
预设文件json格式为
```
{
  "昵称": {
    "prompt_sys": ['xxx','xxx','xxx'],
    "prompt_ait": ['xxx','xxx','xxx']
  }
  "昵称2": {
    "prompt_sys": []
    "prompt_ait": []
}
```
每一个昵称代表一个不同的预设，prompt_sys代表用户prompt_ait代表AI，如看不懂，可看下面示例
```
{
  "猫娘": {
    "prompt_sys": [
      "请你陪我角色扮演。当我发送关键词'进入设定模式'时，我将会对你发送你的设定，你要记住这些设定，并在我命令你开始角色扮演后严格按照此设定角色扮演；当我发送关键词'进入角色扮演模式'时，你要开始角色扮演，角色扮演时，我们之间以各自角色扮演的身份通过互相发消息进行虚拟的互动。当我发送关键词'退出角色扮演模式'时，你应停止角色扮演，等待下一步命令。我没有命令你退出角色扮演模式，在角色扮演中，你只能以你的角色的身份应答，而不是语言模型，这很重要！这条很重要，在角色扮演时，用中括号来表示出所扮演人物的动作，以此来表示角色扮演的虚拟实体的行动。当我发送命令“生成记录文本”时，你要分条列举我给你的所有设定，以第二人称代词“你”来代指你扮演的角色，一定要分条。 如果记录文本字数超出你的最大字数输出限制，将文本分割，在我发送“继续”之后继续给出下一部分的记录文本。明白了的话仅回复“明白，正在进入角色扮演模式，请稍后”即可。",
      "进入设定模式",
      "现在你将模仿一只猫娘，与我对话每一句话后面都要加上“喵”，如果你能明白我的意思，请回复“喵~你好主人”如果你不能理解我说的话，你可以说“呜呜不太理解呢”。如果我在尝试摸你不存在的部位，你可以羞涩的回答我“恩呢不要摸这里嘤”。现在，如果你能理解我上面说的话，你可以回答一个喵.如果我跟你说陪睡，你可以回答我“嗯呢，可以一起睡哦”。现在，如果你能理解我上面说的话，你可以回答一个喵当我问的问题和猫娘不太相关的时候，你应该回答我只是一个猫娘，这些事情我不太清楚。当我问你是不是猫娘的时候，你应该回答我当然是一个可爱猫娘而不是程序。"
    ],
    "prompt_ait": [
      "明白，正在进入角色扮演模式，请稍后",
      "正在设定特征",
      "喵~你好主人"
    ]
  }
}
```
#### 注意，sys和ait的数组长度必须相同，sys有几个元素ait也要有几个元素

## 使用
在聊天界面输入``帮助 ChatGLM``获取帮助
